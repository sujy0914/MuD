<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="global.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<style>

    body {
  font-family: Arial, sans-serif;
  text-align: center;
  margin-top: 100px;
}
input {
  padding: 10px;
  margin: 5px;
  width: 200px;
}
button {
  padding: 10px 20px;
  margin-top: 10px;
}

.login-page {
  background-color: #ffffff;
  display: flex;
  flex-direction: row;
  justify-content: center;
  width: 100%;
}

.login-page .div {
  background-color: #ffffff;
  width: 1440px;
  height: 1100px; /* 높이 약간 증가 */
  position: relative;
}

.login-page .overlap-2 {
  position: absolute;
  width: 700px; /* 너비 증가 */
  height: 800px; /* 높이 증가 */
  top: 290px; /* 위치 재조정 */
  left: 370px;
}

.login-page .rectangle {
  position: absolute;
  width: 650px; /* 확장 */
  height: 600px; /* 확장 */
  top: 50px;
  left: 0;
  background-color: #fbf6f6;
}

.login-page .text-wrapper-2 {
  position: absolute;
  width: 200px;
  top: 0px;
  left: 10px;
  font-family: "Pathway Extreme-Light", Helvetica;
  font-weight: 300;
  color: #0000008a;
  font-size: 34px; /* 텍스트 약간 확대 */
  letter-spacing: 0;
  line-height: normal;
}

.rectangle-input {
  position: absolute;
  width: 550px; /* 너비 증가 */
  height: 80px;  /* 높이 증가 */
  padding: 0px 10px;
  font-size: 27px;
  font-family: "Playfair Display-Regular", Helvetica;
  color: #000;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 6px;
  box-sizing: border-box;
}

.rectangle-input::placeholder {
  color: #aaa;
}

.login-button {
  position: absolute;
  top: 820px; /* 위치 내려줌 */
  left: 50%;
  transform: translateX(-50%);
  width: 250px; /* 너비 증가 */
  height: 70px; /* 높이 증가 */
  line-height: 70px;
  background-color: #bc878791;
  color: #fff;
  font-size: 28px; /* 글자 확대 */
  text-align: center;
  border-radius: 6px;
  cursor: pointer;
}

input#userId { top: 150px; left: 33px; }
input#password { top: 270px; left: 33px; }
</style>
<body>
<div class="login-page">
    <div class="div">
        <div id="header"></div>
        <div class="overlap-2">
            <div class="rectangle"></div>
            <div class="text-wrapper-2">Login</div>
            <input id="userId" class="rectangle-input" type="text" placeholder="ID" />
            <input id="password" class="rectangle-input" type="password" placeholder="Password" />
        </div>
        <div id="loginButton" class="login-button">Login</div>
    </div>
</div>

<script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });

    const userIdInput = document.getElementById('userId');
    const passwordInput = document.getElementById('password');
    const loginButton = document.getElementById('loginButton');

    loginButton.addEventListener('click', async function () {
      const userId = userIdInput.value.trim();
      const password = passwordInput.value.trim();

      if (!userId || !password) {
        alert('아이디와 비밀번호를 입력해야 합니다.');
        return;
      }

      try {
        const response = await fetch('http://localhost:8080/api/users/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ userId, password }),
          credentials: 'include'
        });

        const result = await response.json();

        if (response.ok) {
          localStorage.setItem("userId", result.userId);
          alert('로그인 성공!');
          window.location.href = "main.html";
        } else {
          alert('로그인 실패: ' + (result.message || '알 수 없는 오류'));
        }
      } catch (error) {
        console.error('Error:', error);
        alert('서버 연결에 실패했습니다.');
      }
    });
</script>
</body>
</html>
